/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#include <boost/test/floating_point_comparison.hpp>
#include <boost/test/test_tools.hpp>    
#include <boost/test/unit_test.hpp>

#include "xc_kit/xc_functionals.hpp"

namespace {
    const char* const slater_x_data[] = {
        "0.17E+01 0.17E+01 -3.7759272083607622306333592575035826988544185312681994846723914321 -1.4807557679846126394640624539229736073938896201051762684989770322 -1.4807557679846126394640624539229736073938896201051762684989770322 -0.2903442682322769881302083242986222759595862000206227977448974573 0 -0.2903442682322769881302083242986222759595862000206227977448974573 ",
        "0.17E+01 0.17E+01 -3.7759272083607622306333592575035826988544185312681994846723914321 -1.4807557679846126394640624539229736073938896201051762684989770322 -1.4807557679846126394640624539229736073938896201051762684989770322 -0.2903442682322769881302083242986222759595862000206227977448974573 0 -0.2903442682322769881302083242986222759595862000206227977448974573 ",
        "0.15E+01 0.15E+01 -3.1955581903837242787195755903797872931037092178699144625529292265 -1.4202480846149885683198113735021276858238707634977397611346352118 -1.4202480846149885683198113735021276858238707634977397611346352118 -0.3156106854699974596266247496671394857386379474439421691410300471 0 -0.3156106854699974596266247496671394857386379474439421691410300471 ",
        "0.88E-01 0.88E-01 -0.7284536904137681723287612046783684297378156221305540786384191022e-1 -0.5518588563740667972187584883927033558619815319170864232109235623 -0.5518588563740667972187584883927033558619815319170864232109235623 -2.090374455962374231889236698457209681295384590595024330344407433 0 -2.090374455962374231889236698457209681295384590595024330344407433 ",
        "0.18E+04 0.18E+04 -0.4074944753199530748813920685378411098063195570952949980291831779e5 -15.092387974813076847458965501401522585419242855381296223303080664 -15.092387974813076847458965501401522585419242855381296223303080664 -0.2794886662002421638418326944703985663966526454700240041352422345e-2 0 -0.2794886662002421638418326944703985663966526454700240041352422345e-2 ",
        "0.18E+04 0.18E+04 -0.4074944753199530748813920685378411098063195570952949980291831779e5 -15.092387974813076847458965501401522585419242855381296223303080664 -15.092387974813076847458965501401522585419242855381296223303080664 -0.2794886662002421638418326944703985663966526454700240041352422345e-2 0 -0.2794886662002421638418326944703985663966526454700240041352422345e-2 ",
        "0.16E+04 0.16E+04 -0.3482718411453897197813197354722739026615121294741543931610845409e5 -14.5113267143912383242216556446780792775630053947564330483785225375 -14.5113267143912383242216556446780792775630053947564330483785225375 -0.3023193065498174650879511592641266516158959457240923551745525528e-2 0 -0.3023193065498174650879511592641266516158959457240923551745525528e-2 ",
        "0.26E+00 0.26E+00 -0.3088323946472914123122536574585866149100564191446074931261710312 -0.791877934993054903364752967842529781820657484986173059297874439 -0.791877934993054903364752967842529781820657484986173059297874439 -1.0152281217859678248266063690288843356675095961361193067921467167 0 -1.0152281217859678248266063690288843356675095961361193067921467167 ",
        "0.53E+05 0.53E+05 -0.3705039801427249441557501302130771972701414337315683762083837321e7 -46.6042742317893011516666830456700877069360294001972800262117902062 -46.6042742317893011516666830456700877069360294001972800262117902062 -0.2931086429672283091299791386520131302323020716993539624290049698e-3 0 -0.2931086429672283091299791386520131302323020716993539624290049698e-3 ",
        "0.47E+05 0.47E+05 -0.3156619212842281424644295905950252389515011342937267022367447203e7 -44.7747406076919351013375305808546438229079623111669081186871943782 -44.7747406076919351013375305808546438229079623111669081186871943782 -0.3175513518276023766052307133393946370419004419231695611254410948e-3 0 -0.3175513518276023766052307133393946370419004419231695611254410948e-3 ",
        "0.15E+00 0.15E+00 -0.1483246721364495320559104805901679142751129239124733041304528147 -0.6592207650508868091373799137340796190005018840554369072464569542 -0.6592207650508868091373799137340796190005018840554369072464569542 -1.4649350334464151314163998082979547088900041867898597938810154539 0 -1.4649350334464151314163998082979547088900041867898597938810154539 ",
        "0.35E+01 0.00E+00 -4.9448423308272755416549994766064672332691030131037260670760392337 -1.8837494593627716349161902768024637079120392430871337398384911367 0 -0.1794047104155020604682085977907108293249561183892508323655705844 0 0 ",//
        "0.35E+01 0.00E+00 -4.9448423308272755416549994766064672332691030131037260670760392337 -1.8837494593627716349161902768024637079120392430871337398384911367 0 -0.1794047104155020604682085977907108293249561183892508323655705844 0 0 ",//
        "0.30E+01 0.00E+00 -4.0261510302284228767975999139047139432832279832023104850984813701 -1.7894004578792990563544888506243173081258791036454713267104361645 0 -0.1988222730976998951504987611804797009028754559606079251900484627 0 0 ", //
        "0.58E-01 0.00E+00 -0.2089131195075292497323523074759382343210491801654273709249250314e-1 -0.4802600448448948269709248447722718030368946670469594733906322561 0 -2.7601152002580162469593381883463896726258314198101119160381164149 0 0 ",//
        "0.82E+02 0.81E+02 -657.6156838036915693103993045794170442467638603523281290476142029403 -5.390202444799826281134857098424962842940201523787658207392474991 -5.3682013736378971690634665518729519243776373109364139801313084937 -0.2191139205203181415095470365213399529650488424303926100566046744e-1 0 -0.2209136367752221057227764013116441121143060621784532502111649586e-1 ",
        "0.39E+02 0.38E+02 -241.9481478378922885450298040521262430642879471501570782701183590772 -4.2074793668350021121839407232318838808044122116956063578712972621 -4.171206187998893921531562733248899633359961051160020782539751374 -0.3596136210970087275370889507035798188721719839056073810146407916e-1 0 -0.3658952796490257825904879590569210204701720220315807703982238047e-1 ",
        "0.13E+00 0.95E-01 -0.101616142697606775250603678976288434679502640700257404892224054 -0.6285139335191904160148266789745326656911201677079985151671855798 -0.5661197779576941710759028459827578915735919206838954338726099652 -1.6115741885107446564482735358321350402336414556615346542748348201 0 -1.9863851858164707757049222666061680406090944585399839785003858429 ",
        "0.78E-01 0.31E-01 -0.4007310734308144979915714227877098870764278859581334239318923817e-1 -0.5301091821273772047792384083184957477964042121165220362789636133 -0.3897514059625756266482449631027521488840061155697549793922523351 -2.2654238552452017298258051637542553324632658637458206678588188603 0 -4.1908753329309207166477953021801306331613560813952148321747562919 ",
        "0.50E+02 0.49E+02 -338.2531350272152129769248168751678637622498362563272946538501700932 -4.5707814973408323119351515105986869553256841304642379735172012993 -4.5401041871274558171253506184412817125860321459569624665838128264 -0.3047187664893888207956767673732457970217122753642825315678134199e-1 0 -0.3088506249746568583078469808463456947337436833984328208560416888e-1 ",
        "0.40E+02 0.40E+02 -254.58826030729325852871308927403623586184753330471359706952850027 -4.2431376717882209754785514879006039310307922217452266178254750043 -4.2431376717882209754785514879006039310307922217452266178254750043 -0.353594805982351747956545957325050327585899351812102218152122917e-1 0 -0.353594805982351747956545957325050327585899351812102218152122917e-1 ",
        "0.12E+00 0.10E+00 -0.9826815002729856424269630673455235471335605540421757108264225899e-1 -0.6119663483891738920601341117539239865956903192020902343471373871 -0.5758823822969721860971231556893226122632523556803926665519985887 -1.6999065233032608112781503104275666294324731088946950954087149641 0 -1.9196079409899072869904105189644087075441745189346422218399952959 ",
        "0.48E-01 0.25E-01 -0.230346081831011962438443540229449306990412288714130843539539429e-1 -0.4509006607147306466490403594306133621578769470172501767368475128 -0.3627831678597809581055413911169519819390751348689108262094630634 -3.1312545882967406017294469404903705705408121320642373384503299504 0 -4.837108904797079441407218548226026425854335131585477682792840846 ",
        0 };

    const char* const vwn3_c_data[] = {
        "0.17E+01 0.17E+01 -0.3499718043733293028566208606682023038009571319261346838412693868 -0.1121820560890787702841115112469431334853067613110572472800836394 -0.1121820560890787702841115112469431334853067613110572472800836394 0.1649281157538607739810643958813551592868242309827853621851758469e-1 -0.2207069524942696362562705650414304058675838176502699077564797921e-1 0.1649281157538607739810643958813551592868242309827853621851758469e-1 ",
        "0.17E+01 0.17E+01 -0.3499718043733293028566208606682023038009571319261346838412693868 -0.1121820560890787702841115112469431334853067613110572472800836394 -0.1121820560890787702841115112469431334853067613110572472800836394 0.1649281157538607739810643958813551592868242309827853621851758469e-1 -0.2207069524942696362562705650414304058675838176502699077564797921e-1 0.1649281157538607739810643958813551592868242309827853621851758469e-1 ",
        "0.15E+01 0.15E+01 -0.305331202144592981144713839947906392375088950611816457310751718 -0.1109967513465002311754351623781449716486945578419753533889620461 -0.1109967513465002311754351623781449716486945578419753533889620461 0.1839006721313755270770347012466669312726493810426926518132090336e-1 -0.2469517576620496152662548040771238080355096536866165087551089042e-1 0.1839006721313755270770347012466669312726493810426926518132090336e-1 ",
        "0.88E-01 0.88E-01 -0.1350622424445009635295801690375627145091654095667749658384445325e-1 -0.8512210797229178875523827011336222930352486372826454867615393241e-1 -0.8512210797229178875523827011336222930352486372826454867615393241e-1 0.2055091646628815607329585200200395236434689572180959434364380835 -0.3047960118190303196221379823384116640601316702998939021470215462 0.2055091646628815607329585200200395236434689572180959434364380835 ",
        "0.18E+04 0.18E+04 -0.6164141801046483923091279237498390538892446667263104024994678799e3 -0.1813825955511751841653902678786913531137604830471535550148564807 -0.1813825955511751841653902678786913531137604830471535550148564807 0.3111330646872221886191941153223980885153351801312254943893857336e-4 -0.367869438215011694942945638520088162475704107017988066322747788e-4 0.3111330646872221886191941153223980885153351801312254943893857336e-4 ",
        "0.18E+04 0.18E+04 -0.6164141801046483923091279237498390538892446667263104024994678799e3 -0.1813825955511751841653902678786913531137604830471535550148564807 -0.1813825955511751841653902678786913531137604830471535550148564807 0.3111330646872221886191941153223980885153351801312254943893857336e-4 -0.367869438215011694942945638520088162475704107017988066322747788e-4 0.3111330646872221886191941153223980885153351801312254943893857336e-4 ",
        "0.16E+04 0.16E+04 -0.5440969549880263691234736094089406660071191641271601478030156987e3 -0.1801800280592201493971422123359770160118955802492743153386704975 -0.1801800280592201493971422123359770160118955802492743153386704975 0.346883386721391130959116850384280858753780521934671578860486187e-4 -0.4106800931179315210799703998605090907635139892309314538913979638e-4 0.346883386721391130959116850384280858753780521934671578860486187e-4 ",
        "0.26E+00 0.26E+00 -0.4473038092922100554562201283579553799016794134695342412898961851e-1 -0.9476162259868086453729334647031959122584670691146273119770445201e-1 -0.9476162259868086453729334647031959122584670691146273119770445201e-1 0.8280696095023832402461750356283660720894892050702308201157308699e-1 -0.1176161611136329890710965898215741914324020839850180245295940478 0.8280696095023832402461750356283660720894892050702308201157308699e-1 ",
        "0.53E+05 0.53E+05 -0.2181764861450503233441929817487503517603537167519169578830580606e5 -0.2161107161130837278182369304108149368284390051524872200835352967 -0.2161107161130837278182369304108149368284390051524872200835352967 0.1332722689975680666104512329746815269335895529531914464899065901e-5 -0.1527197541363518526390112671145319834993446267110630396977051769e-5 0.1332722689975680666104512329746815269335895529531914464899065901e-5 ",
        "0.47E+05 0.47E+05 -0.1923160088318298865648926597583333981212909302725662750996433639e5 -0.2148724922439748043990956957062194250708110010346069734133110172 -0.2148724922439748043990956957062194250708110010346069734133110172 0.1491696449665475196340362113028816560029308636092037604593218182e-5 -0.1710953838798034779480722284830438547754375495529719391169336715e-5 0.1491696449665475196340362113028816560029308636092037604593218182e-5 ",
        "0.15E+00 0.15E+00 -0.24377857312677132218378763814088045027774769512137119446677322e-1 -0.8982494914661955474010952677516317296315837653738809699600962395e-1 -0.8982494914661955474010952677516317296315837653738809699600962395e-1 0.1316648815075468755868779043125263383879264860422166038574207051 -0.1909818792923116836231585728338914714986277101352793523238520398 0.1316648815075468755868779043125263383879264860422166038574207051 ",
//        "0.35E+01 0.00E+00 -0.2265724552262426113109421131941134895663330075861914031880392926 -0.6963001075236181594123677215863802823729857548062994154512312147e-1 -0.3182392294168436764974176376950713525997065843909274238888623887 -0.1418354415249240840410470041286959568956536098655749169168176535e-2 -0.9471146449117907035759737370155426200193891054328322109819625545e-2 0.174454774585562191446958727685538279529672153218861739934994196e10 ",
//        "0.35E+01 0.00E+00 -0.2265724552262426113109421131941134895663330075861914031880392926 -0.6963001075236181594123677215863802823729857548062994154512312147e-1 -0.3182392294168436764974176376950713525997065843909274238888623887 -0.1418354415249240840410470041286959568956536098655749169168176535e-2 -0.9471146449117907035759737370155426200193891054328322109819625545e-2 0.174454774585562191446958727685538279529672153218861739934994196e10 ",
//        "0.30E+01 0.00E+00 -0.19194374104415799898987497191662309428150919658389742901009009 -0.6886543240229128826256329845855577014771746786812936893874174954e-1 -0.3131425530371593309942718941301832565191208575025267206603096674 -0.1651864701783493590928153903840594668943673884494384559922452302e-2 -0.1099207832615497940922739952700166254050621433449326542377860346e-1 0.1999839827070905622577281262680786784268182696949640649916384219e10 ",
//        "0.58E-01 0.00E+00 -0.2635025308408091463353217777145594333456842644418785576691966566e-2 -0.4990224427457735477732665430575896483399044572496462983909329693e-1 -0.1935918796754400406824654033781426634706246232048001972934723818 -0.7954267449380774945187822518157686344341186086483386170516112641e-1 -0.4685350331746662115952041617577199172143384884914424034315880635 0.6084587276094570852932881169057082695748853293465138571452688936e11 ",
        "0.82E+02 0.81E+02 -0.2284258544373575867204927444170419444280135898008143773539428888e2 -0.1494546184548049046426268068524446164751036885292213410947240171 -0.150633911273019224838599200927658329106163207346130775938883945 0.5216146623558320850081324048688043371257457023547051345577876771e-3 -0.6510808754921285095806734983388908397578124033974295547145180232e-3 0.5348421026209333808509908155256637372374871034268841181649704531e-3 ",
        "0.39E+02 0.38E+02 -0.1022099978884784818419471126561244607848766593729559253052013392e2 -0.1413965888064188280538495086466463970170188867472714634183656334 -0.143733401327651701979097446117445519227793319688940139024254235 0.101192081901766940469301654648161795575571644259688190236239352e-2 -0.1297432594354382753328356307183299252482174018263400135054347743e-2 0.1067131023889125942534877192118351556038871263886229353434441457e-2 ",
        "0.13E+00 0.95E-01 -0.176052262903484137526593782182701344349879993763569383161966333e-1 -0.8049838118068134419464873867715233597738075539253486022933437774e-1 -0.9503079432538338893806486593103814325765024125352823892161234114e-1 0.1182671646243507628918555204666910392873747983556297087212071912 -0.2446394099931967987440777745986071781600458077115278623520017209 0.2304657111167857216678513526445344270826380843954966123255859941 ",
        "0.78E-01 0.31E-01 -0.7499367052917195972553929639200722093452804642801980036156961294e-2 -0.657587920716727515487416122432472768961154717087399033063800497e-1 -0.1032370011977025471533893408402613116009555371636114791392937104 0.9564657110473982614534983268414717845806201419614588202141406106e-1 -0.4459144482230275854075859979960687296542539644335720070294155786 0.736479825603540504156222397669217828480250425907299050507416119 ",
        "0.50E+02 0.49E+02 -0.1338605878279032971563745111722972293516826685000045310253641981e2 -0.1441348933367234026499882845035064181450465980622187988606164584 -0.1459938107857520146429863667910679838641383510817971460366790089 0.8117765760406973974330553538077124609411105244194654143004920477e-3 -0.1030102352446988297068314811870886286685854301215555097553908667e-2 0.8459941218926795791925449552953925248597941455610241929649122916e-3 ",
        "0.40E+02 0.40E+02 -0.1064983199786447281930687987171505684477723652430458450668165915e2 -0.1429381869543180182940782057344213891995070500179673613061600394 -0.1429381869543180182940782057344213891995070500179673613061600394 0.1004113142794177535167177178326087349058564852017923336920812676e-2 -0.1252777146700062612658717425545678647526455355237300618036932326e-2 0.1004113142794177535167177178326087349058564852017923336920812676e-2 ",
        "0.12E+00 0.10E+00 -0.1725403073549991066413766947027228486053833296325881898657728698e-1 -0.8302400100433636567974088269981694344879219907813938371792064177e-1 -0.9146488933107000120143498056079534158973929071585495524316604213e-1 0.1399516766077939286088271696317846117249816755041290849681574309 -0.2503104618151009030250215368097750949835732096887965774767875273 0.2061169602174577737100334165543977995995972460401668877228661414 ",
        "0.48E-01 0.25E-01 -0.4929803677715813114761313053450950367535174091261001833752631113e-2 -0.6661349283227633248164661262734223664582661950005835373239213975e-1 -0.9192113539502384023907809571134921779116299362831787744982444892e-1 0.1937584255936222186636900169940290867313581842303330881197956027 -0.6434006672315753742627913497441761721240985765262677212973601951 0.8079812385530961271822989036015989104575908753607126973153082501 ",
        0
    };

    const char* const vwn_c_data[] = {
        "0.17E+01 0.17E+01 -0.2789781773674641338609574619495687743717642002919428723271591242 -0.90789630152972246668298936615580006772971738359561468969696229e-1 -0.90789630152972246668298936615580006772971738359561468969696229e-1 0.1294432149847152423043757588981640651575747229364862998660538396e-1 -0.1825599014220249432937912911525223712960676217425146959778390296e-1 0.1294432149847152423043757588981640651575747229364862998660538396e-1 ",
        "0.17E+01 0.17E+01 -0.2789781773674641338609574619495687743717642002919428723271591242 -0.90789630152972246668298936615580006772971738359561468969696229e-1 -0.90789630152972246668298936615580006772971738359561468969696229e-1 0.1294432149847152423043757588981640651575747229364862998660538396e-1 -0.1825599014220249432937912911525223712960676217425146959778390296e-1 0.1294432149847152423043757588981640651575747229364862998660538396e-1 ",
        "0.15E+01 0.15E+01 -0.2428833979859253512360768329744622859445183467552180993949040253 -0.8966139519661967842704135247970331597620401724859804554851739386e-1 -0.8966139519661967842704135247970331597620401724859804554851739386e-1 0.1446497444642464024285460144705486741243846989525623805328306936e-1 -0.2046383469105482844684009321412523036525196491722068440729438927e-1 0.1446497444642464024285460144705486741243846989525623805328306936e-1 ",
        "0.88E-01 0.88E-01 -0.1014837207802136048343333168194261809073948391592820065058920729e-1 -0.6532893365353062091500986374398353328910629466348665494922346479e-1 -0.6532893365353062091500986374398353328910629466348665494922346479e-1 0.171179303518851655069634803623972301896280369950217368313902323 -0.2632374424727533625078298707414669742577434509715712664041228611 0.171179303518851655069634803623972301896280369950217368313902323 ",
        "0.18E+04 0.18E+04 -0.5327414770226664823738796053562106750775096703737448408553218898e3 -0.1579446717042195085368828120916234830676068939156314445493193614 -0.1579446717042195085368828120916234830676068939156314445493193614 0.2236695882677218241625932728223258538955934231952378144744953402e-4 -0.2795047500654723526753269495876505144700391647287431945873854919e-4 0.2236695882677218241625932728223258538955934231952378144744953402e-4 ",
        "0.18E+04 0.18E+04 -0.5327414770226664823738796053562106750775096703737448408553218898e3 -0.1579446717042195085368828120916234830676068939156314445493193614 -0.1579446717042195085368828120916234830676068939156314445493193614 0.2236695882677218241625932728223258538955934231952378144744953402e-4 -0.2795047500654723526753269495876505144700391647287431945873854919e-4 0.2236695882677218241625932728223258538955934231952378144744953402e-4 ",
        "0.16E+04 0.16E+04 -0.4697956482789723161763947821101241007391727502019218211449772059e3 -0.1567614184920598683663882551989230464447823297031513792405050698 -0.1567614184920598683663882551989230464447823297031513792405050698 0.2496248187382199554506922324072807989770851336543300078160028904e-4 -0.3123855640002369422377455168859965091224181149743440371754890741e-4 0.2496248187382199554506922324072807989770851336543300078160028904e-4 ",
        "0.26E+00 0.26E+00 -0.3443009813102924371484003311353458415045691617656768615832061842e-1 -0.7431967782054890840995881976043994344167107273885414058246667226e-1 -0.7431967782054890840995881976043994344167107273885414058246667226e-1 0.6735170432620078269666690363629735794360240110729447260499067831e-1 -0.9999584538560973319206799470535465284235950170938139247804844497e-1 0.6735170432620078269666690363629735794360240110729447260499067831e-1 ",
        "0.53E+05 0.53E+05 -0.1930164405897634101174795265298905602218275303228714252142587805e5 -0.1922718937436800840243085845975519044567103421082153284022343015 -0.1922718937436800840243085845975519044567103421082153284022343015 0.9349753670616561256667639975709834979835235603355696143219014058e-6 -0.1127914390044211151570717048844644892303645158789167079024926754e-5 0.9349753670616561256667639975709834979835235603355696143219014058e-6 ",
        "0.47E+05 0.47E+05 -0.1700160418061620330770403304156010873146148481386659849290706774e5 -0.1910435817876476781428360418618864241320355381902348401773731188 -0.1910435817876476781428360418618864241320355381902348401773731188 0.1047260972279432247383329310494397490012123580736529075368930711e-5 -0.126473945017258013719845569888119305257934418359025724299285136e-5 0.1047260972279432247383329310494397490012123580736529075368930711e-5 ",
        "0.15E+00 0.15E+00 -0.1854322702300589356054788932337140550369279514797780746919336412e-1 -0.6970249333275721040377072568788308439344195193337432844795088987e-1 -0.6970249333275721040377072568788308439344195193337432844795088987e-1 0.1083563256307100175547866616540515195240810068539051714001176266 -0.1636793689414180313103903313083355870804019025428640320376794976 0.1083563256307100175547866616540515195240810068539051714001176266 ",
//        "0.35E+01 0.00E+00 -0.1496739208004999118858027588513878955144600178922590362643619737 -0.4717897149509536277843984508955237325848417131905592367221440737e-1 -0.370218491357535234528738984921862267782143152835370170706556866 -0.1304687102914121763887016727625105322693231453330156046548759907e-2 -0.1227548964190373437961147624810995363254811533638731870647075186e-1 0.1793334546009907878776005069562900014235619774356016262470015428e10 ",
//        "0.35E+01 0.00E+00 -0.1496739208004999118858027588513878955144600178922590362643619737 -0.4717897149509536277843984508955237325848417131905592367221440737e-1 -0.370218491357535234528738984921862267782143152835370170706556866 -0.1304687102914121763887016727625105322693231453330156046548759907e-2 -0.1227548964190373437961147624810995363254811533638731870647075186e-1 0.1793334546009907878776005069562900014235619774356016262470015428e10 ",
//        "0.30E+01 0.00E+00 -0.1262556465531276313396123105795090279091254900302313488880584363 -0.4647660573637577536177549861848700012571855928013637854096106877e-1 -0.3636160230667053078112737069314426070040111744730576902834022937 -0.1515409496511558847505549266985267501781029399073389363537690669e-2 -0.1423247139364975998378853096257798283120732100517259872756277686e-1 0.2056989547520458331059104111538221343968332387351408357122234268e10 ",
//        "0.58E-01 0.00E+00 -0.1519401150372003983942272161247906986787185636945478172687969593e-2 -0.2979931186120076854599410443354499221313513532172034674302195419e-1 -0.2112469643196354278233016007127336239339097733565903546931989866 -0.6631790367891727034768783597196284407182880552158473070652263117e-1 -0.5840617456486297719451590520178657740128512015374185222993150189 0.6358026437692911240427490314735880695410917370960109864740867729e11 ",
        "0.82E+02 0.81E+02 -0.1918150885376542916922325108640646507380134012118563314616484733e2 -0.1268163760703577246068464716042179738564694347177429984138915242 -0.1277197325990987119729043927692604051564588773637407974774075169 0.3867834354513876381938854155917939357362236548187647058795831598e-3 -0.5114519135892277330229632617724050501088412950439403373153457322e-3 0.3970509910542498267162430874234936290586848031724396869882745101e-3 ",
        "0.39E+02 0.38E+02 -8.5107791067209992384444127572519249727942320154594082675336481724 -0.1190990589951097769164274023748005186264683124425888755223469162 -0.1209060449042658899948877750134264490322373182911224268584774173 0.7568361817017621938985316051796452549354142217517238896443263805e-3 -0.1028612818298121679193463613751824871515695119145608513064828417e-2 0.8001361750826369941589357756437473639459984065137664247002792742e-3 ",
        "0.13E+00 0.95E-01 -0.1329289383103036040373914578609341950462786238664913649062566309e-1 -0.6159134476539315343221063616371217468673434600131784257097056006e-1 -0.7391254782278294997576789454957096100276635242078606044838724033e-1 0.9638110059928268472997991663560358449015601527701489219519375972e-1 -0.2107909843674050822256615376424996280714272750272111360823983051 0.1936553604281964808957180383728851449681494981636534009805308171 ",
        "0.78E-01 0.31E-01 -0.5516360817565785511566654155237200861263506414439197210466483613e-2 -0.4825901715667356891480724255218753080173149500940667077837030076e-1 -0.8114940552167889119397745821662194180243058982708434192245595323e-1 0.8643991667357141557335495153621187509821320645948770113814517191e-1 -0.4176322875608168841132221113980736037610968228226603073364962839 0.7102282075278057410345213995636633626092119069859925964522352034 ",
        "0.50E+02 0.49E+02 -0.1117861103836536666967117700861931193760792356684857328792354275e2 -0.1217114272261595883270659676869460387154207044699758091217805672 -0.123144247973362285055211692423822086195301517505154122656357301 0.6053863823341847552704626283521396358892409023228526060355068964e-3 -0.8141177372521072659121875165268026961990269398185552552304950677e-3 0.6321280501351474584054374602167864496711989268032715070383210059e-3 ",
        "0.40E+02 0.40E+02 -0.8871778588367421250249770441089401941300211581178733999946806098e1 -0.1203657099952461123702912543996828187253135188632615665212993536 -0.1203657099952461123702912543996828187253135188632615665212993536 0.751587360249894738057066925424396065993449675909587237757957032e-3 -0.9927350360101562889685343730333865351141220604405267001591793201e-3 0.751587360249894738057066925424396065993449675909587237757957032e-3 ",
        "0.12E+00 0.10E+00 -0.1302848325895512112014349227535060265984279208112393505689736681e-1 -0.6371045941875566214801626440775261855175622683252160424703262726e-1 -0.7086740294593595105256333752654885865968804257753976880220567907e-1 0.1148718665392503601832334884526266623793744938676971760431061742 -0.2154999911367274597955880841749778369882798124668926525289167931 0.1721600068821652007001895326434556849417166483433682480609065892 ",
        "0.48E-01 0.25E-01 -0.3604399236098952886822614619556918232422952305317216885184836589e-2 -0.4886599014207676295926933402433852430961562729659286825487845153e-1 -0.7089546194042616556227471946019278338008423668082629832342911463e-1 0.1643721149707121078442597386744881732336731437947051258925856096 -0.5746400895889005832349432651228449602847005686507153696977340864 0.7245067695395428087213915464660129822492453061689805802711089958 ",
        0};

    const char* const pw92_c_data[] = {
        "0.17E+01 0.17E+01 -0.2773444232140272483581810003424811816529493246213439641597426439 -0.9025496285051178107573203394575409997868319715205128362068714412e-1 -0.9025496285051178107573203394575409997868319715205128362068714412e-1 0.1297266262805266901322241903501235525934303790489051279809960267e-1 -0.1827040411728074872733283878401778912665377178468960438458483157e-1 0.1297266262805266901322241903501235525934303790489051279809960267e-1 ",
        "0.17E+01 0.17E+01 -0.2773444232140272483581810003424811816529493246213439641597426439 -0.9025496285051178107573203394575409997868319715205128362068714412e-1 -0.9025496285051178107573203394575409997868319715205128362068714412e-1 0.1297266262805266901322241903501235525934303790489051279809960267e-1 -0.1827040411728074872733283878401778912665377178468960438458483157e-1 0.1297266262805266901322241903501235525934303790489051279809960267e-1 ",
        "0.15E+01 0.15E+01 -0.2414628982913005415683424162129428892721007087143375449285887553 -0.891299404380378020774883241267490321745186192624045298342040382e-1 -0.891299404380378020774883241267490321745186192624045298342040382e-1 0.1450594155924832370798868732253668402456272023075688666502406031e-1 -0.2048635694523047110500403763787959741391530762494647535393926056e-1 0.1450594155924832370798868732253668402456272023075688666502406031e-1 ",
        "0.88E-01 0.88E-01 -0.1011136712621710948204793324364151779268032498775222342323719463e-1 -0.6500483399883445819340770998732981510267434253002108570142810304e-1 -0.6500483399883445819340770998732981510267434253002108570142810304e-1 0.1757514801177691871603555693642039772837432271948644666210807935 -0.2665299317580223192266455432736048589164477649856539563384682368 0.1757514801177691871603555693642039772837432271948644666210807935 ",
        "0.18E+04 0.18E+04 -0.5315613143858321758426735685237670191181684198485578811206232072e3 -0.1576716732028795077138395198908161401922024750657906301400829885 -0.1576716732028795077138395198908161401922024750657906301400829885 0.2221591323512819109128703584424021593693560184882938454879061956e-4 -0.2782899099792049750401416728647172889456547504226028252198124745e-4 0.2221591323512819109128703584424021593693560184882938454879061956e-4 ",
        "0.18E+04 0.18E+04 -0.5315613143858321758426735685237670191181684198485578811206232072e3 -0.1576716732028795077138395198908161401922024750657906301400829885 -0.1576716732028795077138395198908161401922024750657906301400829885 0.2221591323512819109128703584424021593693560184882938454879061956e-4 -0.2782899099792049750401416728647172889456547504226028252198124745e-4 0.2221591323512819109128703584424021593693560184882938454879061956e-4 ",
        "0.16E+04 0.16E+04 -0.4687259180301597327290911004777156875062947171447994758723882336e3 -0.1564821209468499807634145673557626651129609490822439387815196291 -0.1564821209468499807634145673557626651129609490822439387815196291 0.2479283009683081009183735855332602298545434610674607216057077297e-4 -0.3110249514544908131449988868207281343166342157112398673926655465e-4 0.2479283009683081009183735855332602298545434610674607216057077297e-4 ",
        "0.26E+00 0.26E+00 -0.3425884515892398551722476604849204993689789583759745325191504829e-1 -0.7388737907060646932690047159679696545267084651184528057771835942e-1 -0.7388737907060646932690047159679696545267084651184528057771835942e-1 0.6838526034504426554860929653479021059002112541536877644212569076e-1 -0.1007022579293569798894454021003242108818325145328663539453290047 0.6838526034504426554860929653479021059002112541536877644212569076e-1 ",
        "0.53E+05 0.53E+05 -0.1928412011554195816330232976146428367081429230470195597712462452e5 -0.1921453041841411388588873521030563834112328076701423350349702592 -0.1921453041841411388588873521030563834112328076701423350349702592 0.9300828858913321218974863572162637966847868402412166204474388418e-6 -0.1123635090371459854806075618883503145463865356510635163928751117e-5 0.9300828858913321218974863572162637966847868402412166204474388418e-6 ",
        "0.47E+05 0.47E+05 -0.1698562244727945278685594239707037481047570046271603229066050276e5 -0.1909130419989783716903220079228335650234038883631254605780290586 -0.1909130419989783716903220079228335650234038883631254605780290586 0.1041723929876459763994061008111322281455792293928729759231031837e-5 -0.1259910077077009765213988290856064997283555830852274894533819345e-5 0.1041723929876459763994061008111322281455792293928729759231031837e-5 ",
        "0.15E+00 0.15E+00 -0.1846211981433217402502243852041813949845600009525170908339314609e-1 -0.6932137654529192444902251303523531721826809859197420888867356316e-1 -0.6932137654529192444902251303523531721826809859197420888867356316e-1 0.1106059873614101842121002014021634114195511673350100126436096013 -0.1652582917685867051244986649915760395800415621852455453908574272 0.1106059873614101842121002014021634114195511673350100126436096013 ",
//        "0.35E+01 0.00E+00 -0.1499289731007475266937618032319043285982527142716264474712024227 -0.4725549982586313229553242677378871939287434575294559590908072304e-1 -0.3619528755619031815475250590352149081472305390925353664066625406 -0.1305885451137880044967800608500413388439295395138245551307365052e-2 -0.1227862009303525086657365779387936021185737344181237022375562017e-1 0.1768166208584830767794305295940741772297181116258676704985621851e10 ",
//        "0.35E+01 0.00E+00 -0.1499289731007475266937618032319043285982527142716264474712024227 -0.4725549982586313229553242677378871939287434575294559590908072304e-1 -0.3619528755619031815475250590352149081472305390925353664066625406 -0.1305885451137880044967800608500413388439295395138245551307365052e-2 -0.1227862009303525086657365779387936021185737344181237022375562017e-1 0.1768166208584830767794305295940741772297181116258676704985621851e10 ",
//        "0.30E+01 0.00E+00 -0.1264725915340844636416233334683476643934536252419161701743130267 -0.4655249161455359355481625250216223352346493570151961674356214547e-1 -0.3553521886684862280169321690999968342418104916459953608161317433 -0.1516788985563205668972202808215576821052958531274837826119565951e-2 -0.1422111515860659251489318356344845483897237460638535761929078135e-1 0.2028109572181513330250214346492111814532104203094173362637250378e10 ",
//        "0.58E-01 0.00E+00 -0.1522739752811521740104263506698607397755895076737155357249861189e-2 -0.2986370122432865583648255470764116899676716436638559471964839387e-1 -0.2049167262447852820153424746000485278234961974808408165361400003 -0.6637432288714460627787901503923889006016476204374063511268750637e-1 -0.5713738276122816322672708853737956680825676128894021213572266224 0.6318388355595118590397227284972703119173746307831113449636340699e11 ",
        "0.82E+02 0.81E+02 -0.1910234409198846499506138335855084124794591188767901086440941095e2 -0.1263724990129817159063880355401047754550918807423561395664271524 -0.1272711294872869208193983369089468928664099238025451967093396542 0.3841209630081816992715073310150208118971537554918578221331172655e-3 -0.5094124846767026133398225841264198658838846257000241298272867591e-3 0.3943400804376387432035878852530131964157308468415825948908416938e-3 ",
        "0.39E+02 0.38E+02 -8.4714282587416877857370187002976568477880614478601954336529722894 -0.118619938061653607330986959965106332469757322060625012453783567 -0.1204183353872533615100435213448315084183908716789522855002930874 0.7520304272366633621380568464212069661246022667340534183024366475e-3 -0.1024913206711517620267053395339513015218697237344120850421682742e-2 0.7951629002505730513504112745490666452103979488833697003430836948e-3 ",
        "0.13E+00 0.95E-01 -0.1323757384053510187443482450974604506238656852428121630534157988e-1 -0.6115120861245153934182959616287959020479212420234593676837909022e-1 -0.7367120163853853369985700978274728767319702682367577948353391353e-1 0.9860529173909762328564658826595673357917941440882603468087766256e-1 -0.2130388194801599124027059670443637956980577468128363478927058855 0.1982541142921174318087443174619015987619364155309354074474104296 ",
        "0.78E-01 0.31E-01 -0.5491585185235696875949600591633710296290906684818564808014132825e-2 -0.477671629139718118795028644781711219740821518298666580199956831e-1 -0.8126190266509699032155337436098629723854150933002645607968691219e-1 0.8715402346311051213339076812194980842934466598905063523877211857e-1 -0.417984495935013633611745394388103305275264800684447657397031729 0.7185483344051408195161937219002181011476552335043528808693854262 ",
        "0.50E+02 0.49E+02 -0.1112875975602540423556331183011682613046501502297310512489316357e2 -0.1212434152799899376448234160133960515208197783957229953575658827 -0.1226691548037006557519104077386436599750482025754032749920134592 0.6014115447144680530806342093719011640695594604785432018873568419e-3 -0.8110671538592785464762154585485527655450797211025318655161233872e-3 0.6280410690149120741527096423111389461912236237610782314880123387e-3 ",
        "0.40E+02 0.40E+02 -8.8309780602568482275217385913594513267206343288961649679295620435 -0.1198840738772126461908120214395705156085257355597935742264718073 -0.1198840738772126461908120214395705156085257355597935742264718073 0.7468373820942469494603740321975204167877405527139112808112841242e-3 -0.9891405431848381706905079275722220897245639264656295533662236171e-3 0.7468373820942469494603740321975204167877405527139112808112841242e-3 ",
        "0.12E+00 0.10E+00 -0.1297606716826891766090225222251322525078304787574890519374728595e-1 -0.6330677417712193720411681560768720451360084088099569191080276611e-1 -0.7058077684120882088311715331937369880929648252619730731301857248e-1 0.1176149269951492474190149775657998039812356050911051979949277628 -0.2179035755985403889189094557141673749215004599234052641877523698 0.1763345244846335893170084040543757986532877747552749540444538258 ",
        "0.48E-01 0.25E-01 -0.3593088569872517435882887765286707375919414691530941878155811972e-2 -0.4842789943344704520401675168070166729718008608105715708374602243e-1 -0.709976526103260870374493300515902003956774692934062077134831231e-1 0.1695546770911213562732312034080696731474340588010906006663224038 -0.581862691979424684950387704010985211392124267290437079931339731 0.7461019232388088031787423841196173718217060045152939665230132627 ",
        0
    };

    void check_lda_functional(
        const char* const data[], 
        LocalXCFunctional functional)
    {
        const double eps = 1e-12;

        for (std::size_t i = 0; data[i]; ++i) {
            const char* const p = data[i];
            std::istringstream s(p);

            double ra, rb;

            s >> ra >> rb;

            double e;
            double de_dra, de_drb;
            double d2e_drara, d2e_drarb, d2e_drbrb;
//        double de_dgaa, de_dgab, de_dgbb;
//        double d2e_dragaa, d2e_dragbb, d2e_dragbb, d2e_drbgaa, d2e_drbgab, d2e_drbgbb;
//        double d2e_dgaagaa, d2e_dgaagab, d2e_dgaagbb, d2e_dgabgab, d2e_dgbbgab, d2e_dgbbgbb;

            s >> e;
            s >> de_dra >> de_drb;
            s >> d2e_drara >> d2e_drarb >> d2e_drbrb;

            const XCFunctionalData xc = functional(ra, rb, 2);

            if (e != 0)
                BOOST_CHECK_CLOSE(xc.e, e, eps);
            else
                BOOST_CHECK_SMALL(xc.e, eps);

            if (de_dra != 0)
                BOOST_CHECK_CLOSE(xc.de_dra, de_dra, eps);
            else
                BOOST_CHECK_SMALL(xc.de_dra, eps);

            if (de_drb != 0)
                BOOST_CHECK_CLOSE(xc.de_drb, de_drb, eps);
            else
                BOOST_CHECK_SMALL(xc.de_drb, eps);

            if (d2e_drara != 0)
                BOOST_CHECK_CLOSE(xc.d2e_drara, d2e_drara, eps);
            else
                BOOST_CHECK_SMALL(xc.d2e_drara, eps);

            if (d2e_drarb != 0)
                BOOST_CHECK_CLOSE(xc.d2e_drarb, d2e_drarb, eps);
            else
                BOOST_CHECK_SMALL(xc.d2e_drarb, eps);

            if (d2e_drbrb != 0)
                BOOST_CHECK_CLOSE(xc.d2e_drbrb, d2e_drbrb, eps);
            else
                BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);


            BOOST_CHECK_SMALL(xc.de_dgaa, eps);
            BOOST_CHECK_SMALL(xc.de_dgab, eps);
            BOOST_CHECK_SMALL(xc.de_dgbb, eps);
            BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
            BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
            BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
            BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
            BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
            BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
            BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
        }
    }
};

void check_slater_x_functional_accuracy()
{
    check_lda_functional(slater_x_data, slater_x_functional);
}

void check_vwn3_c_functional_accuracy()
{
    check_lda_functional(vwn3_c_data, vwn3_c_functional);
}

void check_vwn_c_functional_accuracy()
{
    check_lda_functional(vwn_c_data, vwn_c_functional);
}

void check_pw92_c_functional_accuracy()
{
    check_lda_functional(pw92_c_data, pw92_c_functional);
}
