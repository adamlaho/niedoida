/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#include <boost/test/floating_point_comparison.hpp>
#include <boost/test/test_tools.hpp>    
#include <boost/test/unit_test.hpp>

#include "xc_kit/xc_functionals.hpp"
    
void check_b3lyp_xc_functional()
{
    const double eps = 1e-7;
    XCFunctionalData xc;
    xc = b3lyp_xc_functional(0.17E+01, 0.17E+01, 0.81E-11, 0.81E-11, 0.81E-11, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.323236848314E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.125186680903E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.125186680903E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.144159896521E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.455761547380E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.144159896521E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.218336878948E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.165375839434E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.218336878948E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.105592839796E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.236203506407E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.657036117021E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.657036117021E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.236203506407E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.105592839796E-02, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.182480573750E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.182480573750E-04, eps);
    xc = b3lyp_xc_functional(0.17E+01, 0.17E+01, 0.17E+01, 0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.323714327026E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.125005562910E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.125005562910E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.141357814083E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.455761547380E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.141357814083E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.220535209854E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.167224803305E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.220535209854E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.993868359460E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.236203506407E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.657036117021E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.657036117021E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.236203506407E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.993868359460E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.150310955024E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.150310955024E-04, eps);
    xc = b3lyp_xc_functional(0.15E+01, 0.15E+01, 0.36E+02, 0.36E+02, 0.36E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.284301452788E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.116897854637E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.116897854637E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.127654157835E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.568120340362E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.127654157835E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.264800968146E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.246962380202E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.264800968146E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.605149740433E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.333125831681E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.899525589269E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.899525589269E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.333125831681E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.605149740433E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.667366853939E-05, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.667366853939E-05, eps);
    xc = b3lyp_xc_functional(0.88E-01, 0.88E-01, 0.87E-01, 0.87E-01, 0.87E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.734765385895E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.471179307798E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.471179307798E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.335031909041E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.709874878725E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.335031909041E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.119087356581E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.461994975007E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.119087356581E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.123500815668E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.654451937611E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.868364651756E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.868364651756E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.654451937611E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.123500815668E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.159379207669E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.159379207669E+00, eps);
    xc = b3lyp_xc_functional(0.18E+04, 0.18E+04, 0.55E+00, 0.55E+00, 0.55E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.329091638490E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.121623185279E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.121623185279E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.137670025981E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.211226609041E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.137670025981E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.221830902630E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.188590666589E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.221830902630E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.101015443866E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.101154717316E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.880291835026E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.880291835026E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.101154717316E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.101015443866E-09, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.145185185089E-16, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.145185185089E-16, eps);
    xc = b3lyp_xc_functional(0.18E+04, 0.18E+04, 0.86E+04, 0.86E+04, 0.86E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.329091662150E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.121623176525E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.121623176525E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.137669901131E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.211226609041E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.137669901131E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.221831014637E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.188590804811E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.221831014637E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.101015166421E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.101154717316E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.880291835026E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.880291835026E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.101154717316E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.101015166421E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.145183686163E-16, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.145183686163E-16, eps);
    xc = b3lyp_xc_functional(0.16E+04, 0.16E+04, 0.37E+10, 0.37E+10, 0.37E+10, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.291662692953E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.113556508147E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.113556508147E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.125212508392E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.258807836033E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.125212508392E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.274482776000E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.302896659912E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.274482776000E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.681575421953E-10, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.139564478099E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.120262598780E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.120262598780E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.139564478099E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.681575421953E-10, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.565478173007E-17, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.565478173007E-17, eps);
    xc = b3lyp_xc_functional(0.26E+00, 0.26E+00, 0.28E+00, 0.28E+00, 0.28E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.281966570096E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.675950257463E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.675950257463E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.132396547866E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.117685000648E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.132396547866E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.805530438829E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.118106298362E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.805530438829E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.363141897451E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.382783053810E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.670327184932E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.670327184932E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.382783053810E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.363141897451E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.830532973290E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.830532973290E-02, eps);
    xc = b3lyp_xc_functional(0.53E+05, 0.53E+05, 0.96E+05, 0.96E+05, 0.96E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.297394905871E+07, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.373790914295E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.373790914295E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.151741774296E-08, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.661349905989E-12, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.151741774296E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.233832366784E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.693519389161E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.233832366784E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.380539524393E-13, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.105409669788E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.110312423429E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.110312423429E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.105409669788E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.380539524393E-13, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.193156282710E-22, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.193156282710E-22, eps);
    xc = b3lyp_xc_functional(0.47E+05, 0.47E+05, 0.29E+14, 0.29E+14, 0.29E+14, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.262386652992E+07, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.348927955181E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.348927955181E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.139622416354E-08, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.810227461136E-12, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.139622416354E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.289681929857E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.109149292582E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.289681929857E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.265777258573E-13, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.145695984127E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.151867150707E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.151867150707E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.145695984127E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.265777258573E-13, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.781950966986E-23, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.781950966986E-23, eps);
    xc = b3lyp_xc_functional(0.15E+00, 0.15E+00, 0.16E+00, 0.16E+00, 0.16E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.141317331691E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.560497981293E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.560497981293E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.221566363225E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.295820080262E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.221566363225E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.110705643629E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.230182661300E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.110705643629E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.561817966912E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.163609821297E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.248982600284E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.248982600284E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.163609821297E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.561817966912E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.393918647938E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.393918647938E-01, eps);
    xc = b3lyp_xc_functional(0.35E+01, 0.00E+00, 0.46E-10, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.399892263115E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.152022926953E+01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.569059565191E-03, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.143793255671E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    //BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    //BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.101564081636E-05, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = b3lyp_xc_functional(0.35E+01, 0.00E+00, 0.34E+01, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.400085169220E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.151949867012E+01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.565718309854E-03, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.144275565036E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    //BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.951896165997E-06, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = b3lyp_xc_functional(0.30E+01, 0.00E+00, 0.20E+03, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.337825554312E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.140181476241E+01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.542857473158E-03, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.183150035577E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    //BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.454347701768E-06, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = b3lyp_xc_functional(0.58E-01, 0.00E+00, 0.47E-01, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.208918715508E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.356452444497E+00, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.563614622931E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.248689706230E+01, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    //BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.497289960388E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = b3lyp_xc_functional(0.82E+02, 0.81E+02, 0.49E+07, 0.49E+07, 0.49E+07, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.597657791792E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.410849174687E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.408944405306E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.480994006130E-05, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.470705833739E-07, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.483282909871E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.199799370665E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.975401299409E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.200660427641E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.260989083811E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.417456492670E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.304958928738E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.311332607385E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.605117741230E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.258390382546E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.305802669194E-12, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.311732004758E-12, eps);
    xc = b3lyp_xc_functional(0.39E+02, 0.38E+02, 0.81E+06, 0.82E+06, 0.82E+06, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.224706205597E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.320409850337E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.317368254169E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.121714301795E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.178441892970E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.122078926901E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.317800393334E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.225886606202E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.318134299631E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.112752322775E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.271686374867E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.213816335145E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.223467723370E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.555234667672E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.106009545608E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.504534758146E-11, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.517448857581E-11, eps);
    xc = b3lyp_xc_functional(0.13E+00, 0.95E-01, 0.15E+00, 0.18E+00, 0.22E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.102364834001E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.520539483697E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.505870943988E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.258581782652E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.549392678215E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.197777936291E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.128917089285E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.313272349310E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.341042522919E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.523813395958E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.350608937430E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.294447027718E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.593594411251E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.879513086335E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.101203673067E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.534218945785E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.530748327798E-01, eps);
    xc = b3lyp_xc_functional(0.78E-01, 0.31E-01, 0.41E-02, 0.38E-02, 0.36E-02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.370908948340E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.451012905270E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.373868193934E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.833833556166E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.302842221212E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.144390664966E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.176591577637E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.519622735771E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.244487009873E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.104993242174E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.393482201769E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, -0.128113035972E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.276123718282E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.131376004203E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.176232793556E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.175699045569E+01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.152026875550E+02, eps);
    xc = b3lyp_xc_functional(0.50E+02, 0.49E+02, 0.11E+06, 0.11E+06, 0.11E+06, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.281521772558E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.369507027847E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.367023184597E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.145690716360E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.114039548301E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.148744723017E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.253527345932E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.706072438256E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.257381602738E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.311415552822E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.147803254770E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.111574735738E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.115460511919E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.262052086299E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.322180557867E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.110200710038E-10, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.116700363054E-10, eps);
    xc = b3lyp_xc_functional(0.40E+02, 0.40E+02, 0.99E+05, 0.98E+05, 0.98E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.213622104931E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.341660378816E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.341704385893E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.186681440156E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.166064527957E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.186895846674E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.300897507679E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.923280211534E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.300737760767E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.459163999447E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.368764035839E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.198031853578E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.198031853578E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.368764035839E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, 0.460585502466E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.213857448925E-10, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.214957808672E-10, eps);
    xc = b3lyp_xc_functional(0.12E+00, 0.10E+00, 0.12E+00, 0.13E+00, 0.14E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.973549787919E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.513422548189E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.498404166041E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.279927749358E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.519372784598E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.257633827920E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.127015732306E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.343297185496E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.957526903923E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.573950472502E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.147046387568E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.406497802386E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.593213054050E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.667542710588E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.258248118537E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.742126486309E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.832697038526E-01, eps);
    xc = b3lyp_xc_functional(0.48E-01, 0.25E-01, 0.46E-02, 0.44E-02, 0.41E-02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.224618905609E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.383393770852E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.343323903582E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.125297829477E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.420751297066E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, -0.137996683570E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.256288375723E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.665869909022E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, -0.188075111055E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, 0.158911884007E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.437905384553E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, -0.204783018941E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.800379663970E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.237012133502E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.529596660601E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgaagaa, 0.551118679586E+01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dgbbgbb, 0.178736912276E+02, eps);
}

