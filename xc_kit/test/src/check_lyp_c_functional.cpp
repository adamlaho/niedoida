/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#include <boost/test/floating_point_comparison.hpp>
#include <boost/test/test_tools.hpp>    
#include <boost/test/unit_test.hpp>

#include "xc_kit/xc_functionals.hpp"
    
void check_lyp_c_functional()
{
    const double eps = 1e-7;
    XCFunctionalData xc;
    xc = lyp_c_functional(0.17E+01, 0.17E+01, 0.81E-11, 0.81E-11, 0.81E-11, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.179175399535E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.567254370239E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.567254370239E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.603063052247E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.562668577012E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.603063052247E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.133393844920E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.152396936370E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.133393844920E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.139567528486E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.291609267169E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.811155700026E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.811155700026E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.291609267169E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.139567528486E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.17E+01, 0.17E+01, 0.17E+01, 0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.178874704439E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.568743789287E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.568743789287E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.603063052247E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.562668577012E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.603063052247E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.138019299001E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.154679607816E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.138019299001E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.139567528486E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.291609267169E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.811155700026E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.811155700026E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.291609267169E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.139567528486E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.15E+01, 0.15E+01, 0.36E+02, 0.36E+02, 0.36E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.148704448499E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.607218516385E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.607218516385E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.741080708899E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.701383136250E-04, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.741080708899E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.303235212020E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.246964871909E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.303235212020E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.192341863313E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.411266458866E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.111052541885E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.111052541885E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.411266458866E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.192341863313E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.88E-01, 0.88E-01, 0.87E-01, 0.87E-01, 0.87E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.465024100803E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.610987646298E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.610987646298E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.694062751783E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.876388739167E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.694062751783E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.939780887292E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.498868805878E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.939780887292E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.228361811495E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.807965355076E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.107205512562E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.107205512562E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.807965355076E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.228361811495E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.18E+04, 0.18E+04, 0.55E+00, 0.55E+00, 0.55E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.237638430952E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.665993271139E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.665993271139E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.540555769454E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.260773591409E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.540555769454E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.144305866044E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.146537621392E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.144305866044E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.158850198364E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.124882367057E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.108678004324E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.108678004324E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.124882367057E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.158850198364E-11, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.18E+04, 0.18E+04, 0.86E+04, 0.86E+04, 0.86E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.237638419413E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.665993325023E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.665993325023E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.540555769454E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.260773591409E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.540555769454E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.144306117017E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.146537792037E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.144306117017E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.158850198364E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.124882367057E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.108678004324E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.108678004324E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.124882367057E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.158850198364E-11, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.16E+04, 0.16E+04, 0.37E+10, 0.37E+10, 0.37E+10, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.204955819468E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.697313972428E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.697313972428E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.658117255270E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.319515846955E-09, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.658117255270E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.328352356048E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.277614126197E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.328352356048E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.217196289305E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.172301824814E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.148472344173E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.148472344173E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.172301824814E-12, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.217196289305E-11, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.26E+00, 0.26E+00, 0.28E+00, 0.28E+00, 0.28E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.216471443930E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.526995644881E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.526995644881E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.127229458316E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.145290124256E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.127229458316E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.134806861660E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.118221268828E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.134806861660E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.160681338920E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.472571671370E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.827564425842E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.827564425842E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.472571671370E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.160681338920E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.53E+05, 0.53E+05, 0.96E+05, 0.96E+05, 0.96E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.712575807209E+04, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.674210020682E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.674210020682E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.190814948140E-11, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.816481365419E-12, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.190814948140E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.495469678644E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.497965254694E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.495469678644E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.196249114596E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.130135394800E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.136188177073E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.136188177073E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.130135394800E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.196249114596E-15, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.47E+05, 0.47E+05, 0.29E+14, 0.29E+14, 0.29E+14, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.615255831041E+04, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.703265205307E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.703265205307E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.233162530668E-11, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.100028081622E-11, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.233162530668E-11, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.110943737062E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.946187279564E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.110943737062E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.270252437366E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.179871585341E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.187490309515E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.187490309515E-15, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.179871585341E-16, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.270252437366E-15, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.15E+00, 0.15E+00, 0.16E+00, 0.16E+00, 0.16E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.106605459023E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.547299644084E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.547299644084E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.303386607339E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.365209975632E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.303386607339E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.346499910453E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.239377906462E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.346499910453E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.624221561613E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.201987433700E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.307385926277E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.307385926277E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.201987433700E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.624221561613E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.35E+01, 0.00E+00, 0.46E-10, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_SMALL(xc.e, eps);
    BOOST_CHECK_SMALL(xc.de_dra, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drara, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.35E+01, 0.00E+00, 0.34E+01, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_SMALL(xc.e, eps);
    BOOST_CHECK_SMALL(xc.de_dra, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drara, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.30E+01, 0.00E+00, 0.20E+03, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_SMALL(xc.e, eps);
    BOOST_CHECK_SMALL(xc.de_dra, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drara, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.58E-01, 0.00E+00, 0.47E-01, 0.00E+00, 0.00E+00, 2);
    BOOST_CHECK_SMALL(xc.e, eps);
    BOOST_CHECK_SMALL(xc.de_dra, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drara, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.82E+02, 0.81E+02, 0.49E+07, 0.49E+07, 0.49E+07, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.903966286601E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.759264713358E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.784370481382E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.907992031805E-07, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.581118313258E-07, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.100370432217E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.141362773226E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.105147646057E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.150485268125E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.565167905921E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.515378386013E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.376492504615E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.384361243685E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.747058939790E-09, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.588190678666E-08, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.39E+02, 0.38E+02, 0.81E+06, 0.82E+06, 0.82E+06, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.402158795173E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.762734644914E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.830226435821E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.301052145436E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.220298633297E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.369624286402E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.331769729999E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.248438749270E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.384280348438E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.398359773843E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.335415277613E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.263970784129E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.275886078235E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.685474898360E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.433118929134E-07, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.13E+00, 0.95E-01, 0.15E+00, 0.18E+00, 0.22E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.535812609335E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.428946532738E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.100396349615E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.178546727213E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.678262565697E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.827650024238E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.309477814856E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.329371433841E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.162055387526E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.781343180939E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.432850540037E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.363514849034E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.732832606483E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.108581862510E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.179156926286E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.78E-01, 0.31E-01, 0.41E-02, 0.38E-02, 0.36E-02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.303154148293E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.244020499979E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.783890652209E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, -0.352365411226E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.373879285446E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.434388664083E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.202330890903E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.536912334084E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.182166278214E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.992049673308E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.485780496011E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, -0.158164241941E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.340893479361E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.162192597781E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.154746697775E+01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.50E+02, 0.49E+02, 0.11E+06, 0.11E+06, 0.11E+06, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.608750998131E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.643435848234E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.656377677365E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.202448437183E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.140789565804E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.237924154032E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.644965086508E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.630065421347E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.684494690431E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.207590458741E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.182473154038E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.137746587331E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.142543841876E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.323521094196E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.221599858116E-07, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.40E+02, 0.40E+02, 0.99E+05, 0.98E+05, 0.98E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.485826625474E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.653859880589E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.653239498026E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.314305582522E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.205017935750E-06, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.314305582522E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.932011907377E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.845990806989E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.927946564209E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.375898792310E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.455264241776E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.244483769850E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.244483769850E-07, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.455264241776E-08, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.375898792310E-07, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.12E+00, 0.10E+00, 0.12E+00, 0.13E+00, 0.14E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.634688010938E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.486068357646E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.739949355207E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.305337986175E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.641200968640E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.698202739086E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.433585531118E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.365108886112E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.100038106732E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.102735565156E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.181538750084E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, 0.501849138748E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.732361795124E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.824126803195E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.165270268130E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = lyp_c_functional(0.48E-01, 0.25E-01, 0.46E-02, 0.44E-02, 0.41E-02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.172301075975E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.294822900234E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.766946918598E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgaa, 0.127140367254E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dgab, 0.519446045760E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dgbb, 0.608118658277E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.427000673980E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.671140471911E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.300158916489E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragaa, -0.631566175836E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragab, -0.540623931547E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_dragbb, -0.252818541902E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgaa, 0.988123041938E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgab, -0.292607572225E+01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbgbb, -0.333300175870E+01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
}

