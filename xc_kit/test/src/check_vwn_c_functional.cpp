/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#include <boost/test/floating_point_comparison.hpp>
#include <boost/test/test_tools.hpp>    
#include <boost/test/unit_test.hpp>

#include "xc_kit/xc_functionals.hpp"
    
void check_vwn_c_functional()
{
    const double eps = 1e-7;
    XCFunctionalData xc;
    xc = vwn_c_functional(0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.278978177367E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.907896301530E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.907896301530E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.129443214985E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.182559901422E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.129443214985E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.278978177367E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.907896301530E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.907896301530E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.129443214985E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.182559901422E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.129443214985E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.15E+01, 0.15E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.242883397986E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.896613951966E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.896613951966E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.144649744464E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.204638346911E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.144649744464E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.88E-01, 0.88E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.101483720780E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.653289336535E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.653289336535E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.171179303519E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.263237442473E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.171179303519E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.18E+04, 0.18E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.532741477023E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.157944671704E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.157944671704E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.223669588268E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.279504750065E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.223669588268E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.18E+04, 0.18E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.532741477023E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.157944671704E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.157944671704E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.223669588268E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.279504750065E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.223669588268E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.16E+04, 0.16E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.469795648279E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.156761418492E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.156761418492E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.249624818738E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.312385564000E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.249624818738E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.26E+00, 0.26E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.344300981310E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.743196778205E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.743196778205E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.673517043262E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.999958453856E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.673517043262E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.53E+05, 0.53E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.193016440590E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.192271893744E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.192271893744E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.934975367062E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.112791439004E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.934975367062E-06, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.47E+05, 0.47E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.170016041806E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.191043581788E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.191043581788E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.104726097228E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.126473945017E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.104726097228E-05, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.15E+00, 0.15E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.185432270230E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.697024933328E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.697024933328E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.108356325631E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.163679368941E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.108356325631E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.35E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.149673920800E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.471789714951E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.130468710291E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.35E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.149673920800E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.471789714951E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.130468710291E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.30E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.126255646553E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.464766057364E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.151540949651E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.58E-01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.151940115037E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.297993118612E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.663179036789E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.82E+02, 0.81E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.191815088538E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.126816376070E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.127719732599E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.386783435451E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.511451913589E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.397050991054E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.39E+02, 0.38E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.851077910672E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.119099058995E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.120906044904E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.756836181702E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.102861281830E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.800136175083E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.13E+00, 0.95E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.132928938310E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.615913447654E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.739125478228E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.963811005993E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.210790984367E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.193655360428E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.78E-01, 0.31E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.551636081757E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.482590171567E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.811494055217E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.864399166736E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.417632287561E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.710228207528E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.50E+02, 0.49E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.111786110384E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.121711427226E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.123144247973E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.605386382334E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.814117737252E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.632128050135E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.40E+02, 0.40E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.887177858837E+01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.120365709995E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.120365709995E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.751587360250E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.992735036010E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.751587360250E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.12E+00, 0.10E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.130284832590E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.637104594188E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.708674029459E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.114871866539E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.215499991137E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.172160006882E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_c_functional(0.48E-01, 0.25E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.360439923610E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.488659901421E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.708954619404E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.164372114971E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.574640089589E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.724506769540E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
}

