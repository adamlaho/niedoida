/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#include <boost/test/floating_point_comparison.hpp>
#include <boost/test/test_tools.hpp>    
#include <boost/test/unit_test.hpp>

#include "xc_kit/xc_functionals.hpp"
    
void check_vwn_rpa_c_functional()
{
    const double eps = 1e-7;
    XCFunctionalData xc;
    xc = vwn_rpa_c_functional(0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.349971804373E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.112182056089E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.112182056089E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.125073604380E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.180852441120E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.125073604380E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.17E+01, 0.17E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.349971804373E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.112182056089E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.112182056089E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.125073604380E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.180852441120E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.125073604380E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.15E+01, 0.15E+01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.305331202145E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.110996751347E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.110996751347E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.139658271595E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.202709357125E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.139658271595E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.88E-01, 0.88E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.135062242445E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.851221079723E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.851221079723E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.161243063381E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.260529910537E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.161243063381E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.18E+04, 0.18E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.616414180105E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.181382595551E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.181382595551E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.221260868588E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.277997242116E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.221260868588E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.18E+04, 0.18E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.616414180105E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.181382595551E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.181382595551E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.221260868588E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.277997242116E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.221260868588E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.16E+04, 0.16E+04, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.544096954988E+03, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.180180028059E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.180180028059E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.246887796092E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.310684502489E-04, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.246887796092E-04, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.26E+00, 0.26E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.447303809292E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.947616225987E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.947616225987E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.641645280793E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.989737282427E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.641645280793E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.53E+05, 0.53E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.218176486145E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.216110716113E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.216110716113E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.928781952796E-06, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.112325680418E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.928781952796E-06, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.47E+05, 0.47E+05, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.192316008832E+05, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.214872492244E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.214872492244E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.104021134253E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.125946873167E-05, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.104021134253E-05, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.15E+00, 0.15E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.243778573127E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.898249491466E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.898249491466E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.102674048027E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.161991045812E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.102674048027E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.35E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.226572455226E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.696300107524E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.141835441525E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.35E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.226572455226E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.696300107524E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.141835441525E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.30E+01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.191943741044E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.688654324023E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.165186470178E-02, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.58E-01, 0.00E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.263502530841E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.499022442746E-01, eps);
    BOOST_CHECK_SMALL(xc.de_drb, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, -0.795426744938E-01, eps);
    BOOST_CHECK_SMALL(xc.d2e_drarb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbrb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.82E+02, 0.81E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.228426570385E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.149597421494E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.150490334370E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.379966004438E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.507893349810E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.390097953941E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.39E+02, 0.38E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.102211380123E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.141671472141E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.143455382380E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.741686147163E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.102100217702E-02, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.784353256853E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.13E+00, 0.95E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.176275882873E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.816985545468E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.936725006686E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.900615404426E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.208635792884E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.184171240319E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.78E-01, 0.31E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.756937583935E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.681479546460E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.999798510193E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.755043006977E-01, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.411777663200E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.674042059170E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.50E+02, 0.49E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.133861697298E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.144355807714E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.145770933057E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.593780503248E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.808216427806E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.620144399044E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.40E+02, 0.40E+02, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.106498319979E+02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.142938186954E+00, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.142938186954E+00, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.736748088158E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.985412092064E-03, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.736748088158E-03, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.12E+00, 0.10E+00, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.172614567022E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.837402607886E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.906950168735E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.107869454021E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.213289389793E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.163291946501E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
    xc = vwn_rpa_c_functional(0.48E-01, 0.25E-01, 2);
    BOOST_CHECK_CLOSE(xc.e, -0.495307468553E-02, eps);
    BOOST_CHECK_CLOSE(xc.de_dra, -0.683765949187E-01, eps);
    BOOST_CHECK_CLOSE(xc.de_drb, -0.896782469545E-01, eps);
    BOOST_CHECK_SMALL(xc.de_dgaa, eps);
    BOOST_CHECK_SMALL(xc.de_dgab, eps);
    BOOST_CHECK_SMALL(xc.de_dgbb, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drara, 0.146529818145E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drarb, -0.568495409612E+00, eps);
    BOOST_CHECK_CLOSE(xc.d2e_drbrb, 0.684785645919E+00, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dragbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_drbgbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagaa, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgaagbb, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgabgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgab, eps);
    BOOST_CHECK_SMALL(xc.d2e_dgbbgbb, eps);
}

